!function(){var initializing=!1,fnTest=/xyz/.test(function(){})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(prop){function Class(){!initializing&&this.init&&this.init.apply(this,arguments)}var _super=this.prototype;initializing=!0;var prototype=new this;initializing=!1;for(var name in prop)prototype[name]="function"==typeof prop[name]&&"function"==typeof _super[name]&&fnTest.test(prop[name])?function(name,fn){return function(){var tmp=this._super;this._super=_super[name];var ret=fn.apply(this,arguments);return this._super=tmp,ret}}(name,prop[name]):prop[name];return Class.prototype=prototype,Class.prototype.constructor=Class,Class.extend=arguments.callee,Class}}(),window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame;var Salmon={};Salmon.util={},Salmon.Canvas=Class.extend({init:function(element,options){options&&(options.fullscreen?this.fullscreen=!0:(this.width=options.width||0,this.height=options.height||0),this.center=options.center||!1,this.centerVertically=options.centerVertically||!1,this.domElement=element,this.context=this.domElement.getContext("2d")||null,this.keys=[]);var that=this;window.addEventListener("keydown",function(e){that.keys[e.keyCode]=!0}),window.addEventListener("keyup",function(e){that.keys[e.keyCode]=!1})}}),Salmon.util.loadImage=function(src){var img=new Image;return img.src=src,img},Salmon.util.boundingBox=function(b1_x,b1_y,b1_w,b1_h,b2_x,b2_y,b2_w,b2_h){return b1_x>b2_x+b2_w-1||b1_y>b2_y+b2_h-1||b2_x>b1_x+b1_w-1||b2_y>b1_y+b1_h-1?!1:!0},Salmon.util.setCanvasFullscreen=function(element){document.body.style.margin=0,element.width=window.innerWidth,element.height=window.innerHeight,element.style.display="inline-block",element.style.float="left"},Salmon.initCanvas=function(canvas,options){var element=null;"string"==typeof canvas&&(element=document.getElementById(canvas)),element||(element=canvas),options&&(options.fullscreen?(Salmon.util.setCanvasFullscreen(element),window.addEventListener("resize",function(){Salmon.util.setCanvasFullscreen(element)})):(options.width&&options.height&&(element.width=options.width,element.height=options.height),options.center&&(element.style.marginRight="auto",element.style.marginLeft="auto",element.style.display="block"),options.centerVertically&&(element.style.position="fixed",element.style.top="50%",element.style.left="50%",element.style.marginLeft=element.width/2*-1+"px",element.style.marginTop=element.height/2*-1+"px")));var canvasObject=new Salmon.Canvas(element,options);return canvasObject},Salmon.init=function(options){var elements=document.querySelectorAll("canvas");elements.forEach(function(element){(element.hasAttribute("salmon")||element.hasAttribute("data-salmon"))&&Salmon.initCanvas(element,options)})},Salmon.initLoop=function(run){run.tick=function(){run(),window.requestAnimationFrame(run.tick)},run.tick()},Salmon.Sprite=Class.extend({textureRect:{position:{x:0,y:0},size:{x:0,y:0}},init:function(_texture,_position,_size){this.position=_position||{x:0,y:0},this.size=_size||{x:0,y:0},this.texture=_texture||null},render:function(context){context&&this.texture&&context.drawImage(this.texture,this.position.x,this.position.y)},renderCropped:function(context){context&&this.texture&&this.textureRect&&context.drawImage(this.texture,this.textureRect.position.x,this.textureRect.position.y,this.textureRect.size.x,this.textureRect.size.y,this.position.x,this.position.y,this.size.x,this.size.y)},colliding:function(sprite){return Salmon.util.boundingBox(this.position.x,this.position.y,this.size.x,this.size.y,sprite.position.x,sprite.position.y,sprite.size.x,sprite.size.y)}}),Salmon.RectangleShape=Class.extend({init:function(_color,_position,_size){this.size=_size||{x:0,y:0},this.position=_position||{x:0,y:0},this.color=_color||"#000"},render:function(context){if(context){var oldStyle=context.fillStyle;context.fillStyle=this.color,context.fillRect(this.position.x,this.position.y,this.size.x,this.size.y),context.fillStyle=oldStyle}}}),Salmon.CircleShape=Class.extend({init:function(_color,_position,_radius){this.radius=_radius||0,this.position=_position||{x:0,y:0},this.color=_color||"#000"},render:function(context){if(context){var oldStyle=context.fillStyle;context.arc(this.position.x+this.radius,this.position.y+this.radius,this.radius,0,2*Math.PI,!1),context.fillStyle=this.color,context.fill(),context.fillStyle=oldStyle}}});